\chapter{Discussion}
\label{chp:discussion} 

\section{Introduction}

So far the report has presented a large number of topics and implementations.

This chapter will seek to assess the implementations presented in chapter \ref{chp:implementation} based on their performance recorded in chapter \ref{chp:testing}. The following discussions will include qualitative evaluation of suitability for offshore robotic maintenance.

This chapter will examine the results presented in chapter \ref{chp:results} and discuss them in light of the initial problem description for this thesis. The first section will assess the extent to which the project covers the problem description. Then the potential strengths and weaknesses of each subsystem.


\section{Task Fulfilment}



\section{Overall Assessment}

The overall system, as it is at the end of this master's project, is a functioning proof of concept for a mobile autonomous robot. All planned modules were implemented. Some of these, however, are only capable of demonstrating basic functionality and the possibility of more robust and complete implementations. The most important features, camera based mapping and navigation, were successfully implemented and configured. 

\subsection{Choice of Development Tools}

Using \ac{ROS} as a development framework, might have been the most important factor that contributed to a functional solution. In the end, \ac{ROS} proved to be a flexible and rich tool, despite its novel structure and initial learning curve. Experienced users of \ac{ROS} will most likely be able to rapidly test and implement robot concepts.  Since its inception in 2007, \ac{ROS} has become a mature and rich set of tools and functionality packages that anyone can implement and develop further. The node structure is also a good way of structuring the entire system into self contained and reusable modules. This makes it easier to reuse parts of this implementation in later projects, and will hopefully benefit ensuing projects on this topic.

\subsection{Assessment of Prototype Design}

\subsubsection{Short}

\subsubsection{Current Design and Robotic Maintenance}

So far, the robot prototype has been developed for a few specific functionalities. A comprehensive and long-term approach towards designing a maintenance robot has not been a priority. This subsection will go through some specific design choices on the current robot, and discuss potential shortcomings. 

A typical offshore installation floor will most likely be made of steel and steel gratings with many holes, gaps and sharp edges\cite{graf2008mobile}. The current mobile base is better suited for completely even surfaces, and would benefit greatly for a more rugged set of wheels. \cite{graf2008mobile} is also referring to a minimum size for passage ways that could serve as guidelines for later prototypes. As the motor control card is an open loop system, slopes and increased friction for whatever reason affect the speed of the mobile base. This may cause the base to slow down, speed up or even stop completely if it is driving up a slope that is too steep.

Given that the navigation stack in \ac{ROS} is thoroughly tested on square or circular bases, designing a new base to be either square or circular could increase the robustness of the navigation system. A holonomic drive could also make the robot more manoeuvrable, which may be useful in tight spaces.

\section{Success and Quality of the ROS Integration}

Integrating and configuring \ac{ROS} with the existing robot was the most time consuming task of this project. The current implementation is capable of autonomous navigation and long-term map building. Remote operation from the \ac{OCS} and Android device is also possible. 



\section{Assessment of RTAB-Map}

The mapping session results demonstrated both strengths and weaknesses  in the chosen mapping method \ac{RTAB-Map}. The results show that multi session mapping works rather well. Especially in environments with a sufficient amount of detectable visual features. 

\subsection{Quality and Thoroughness of the Tests}

\ac{RTAB-Map} was tested in a diverse set of indoor environments as well as in the simulated ''Asphalt'' world in Gazebo. A significant shortcoming of these tests was the lack of testing and comparing different parameter settings for the method. Further parameter tuning and better mapping techniques could have benefited the mapping performance.

Another shortcoming is the small number of live mapping trials. Configuring and learning to use the mapping system was a time consuming process. Problems with the robot hardware and the environment itself gave rise to additional delays. The laptop running \ac{ROS} and the on-board car battery had to be recharged periodically, which was a time consuming process. The live loop closure tests were carried out at times when a lot of students were moving through the hallways. These factors made it difficult to perform comparable tests, and proved to be a complicating factor for the appearance based mapping system. 

A third weakness in these trials is that the system was tested with only one sensor configuration. \ac{RTAB-Map} can utilize both a RGB-D camera, a LIDAR and odometers, but these tests were only carried out with the Kinect and the LIDAR.

\subsection{Weaknesses}

Appearance based loop closure detection with \ac{RTAB-Map} has many confirmed and potential weaknesses that must be addressed. Figure \ref{fig:gazebo_lc_features} from a simulator session illustrates an incorrect loop closure detection with a subsequent incorrect odometry correction of the previously visited locations. The figure shows that the matched features are based on the ground plane in the simulated world. Having a feature rich ground plane could be a weakness with the simulated world, as it is not was not a good analogue to the real input. The depth map generated by the Kinect was in fact quite sparse at the ground plane. Another error that occurred during simulations is incorrect merging of two maps of the same area (figure \ref{Incorrect_lc_detection}). This particular event was caused by having two very similar locations in the same area. A potential problem is that the appearance of the environment will change based on the time of day, time of year and potential wear and tear on the surroundings. How robust the feature detectors (\ac{SIFT}, \ac{SURF}, \ac{ORB} etc.) are to such changes was not investigated during this project.

\subsection{Strengths}

\ac{RTAB-Map} is very feature rich. It supports many sensor configurations, including stereo cameras. The \ac{ROS} wrapper makes it easy to integrate the method into an existing robot system. The developer or user has access to hundreds of parameters to tailor and fine-tune the mapping system. Object recognition and 3D obstacle detection is also useful features that could support a maintenance robot.


\subsection{Suitability For Robotic Maintenance}

The fact that \ac{RTAB-Map} is suitable

\ac{RTAB-Map} is a feature rich mapping system with many capabilities that can make it suitable for a remotely operated and autonomous maintenance robot. 

\subsection{Mapping}

\begin{itemize}
\item Repairing broken maps? What to do when map is partially broken.
\item Poor odometry when surrounding are in motion, or when laser features are difficult to detect. System can be fooled easily. 
\end{itemize}

Mapping with \ac{RTAB-Map} 

Both the simulated and the live trials show that \ac{RTAB-Map} is able to perform \ac{SLAM}. 

Mapping trials in the Gazebo simulator
\ac{RTAB-Map} can be tuned and configured with hundreds of parameters.

\subsection{The Kinect Sensor}



\section{Navigation}
\begin{itemize}
\item Rectangle base vs. square base.
\item holonomic wheel.
\item Open loop wheel control (stuck when friction is high.)
\item Same as for mapping. Poor odometry when surrounding are in motion, or when laser features are difficult to detect. System can be fooled easily. 
\end{itemize}

Integrating the \ac{ROS} navigation stack into a new mobile base was in itself a fairly simple procedure. Finding a good configuration turned out to be a more complicated process. Navigation was tested on both the simulator and the live robot. It became apparent during the testing sessions that the behaviour of the simulated robot was not analogue to the real robot. Recall that the simulated robot is controlled by a slip steering plugin in Gazebo, while the real robot is closer to a differential drive vehicle. In addition, the motor control in the real robot is an open loop system. The wheel commands from \ac{ROS} will normally result in a lower linear velocity and yaw rate. As a consequence of this discrepancy between the real and simulated robots, the performance assessment of navigation stack in the simulator will have a reduced weight.

It is important to emphasize that the navigation stack was implemented in its simplest form in this thesis, and the assessment will therefore be limited. 

\subsection{The Tuning Process}

There are no official tuning strategies for the navigation stack in \ac{ROS} besides a basic guide to give users a general idea of where to start and what to check\cite{ROS_navigation_tuning}. The tuning process is currently a ''change and check'' process partially based on guesswork or copying similar solutions from other projects. This is far from ideal, as it is both time consuming and a hindrance for finding an optimal solution. 

It should be noted that the navigation stack has been thoroughly tested on robots with square or circular bases. The highly rectangular base ($80x37 cm^2$) on this robot may have been a handicap.

As with the \ac{SLAM} test sessions on the live robot, the cumbersome hardware and limited battery life significantly constrained the amount of time available for testing. 

Based on the test results, the live robot should have a higher minimum speed setting. If the motor control card is expanded with a speed regulator, the minimum speed may be reduced.

\subsection{Performance}

Live testing showed promising results, despite a few quirks. The live robot would reliably plan a path to a goal location and move the base to this location. Sometimes, the robot would stop a few centimetres before reaching the coal location.

\section{Suitability for Offshore Maintenance}

This is just a prototype. Mobility issues.
Kinect-like sensors and ROS could be useful. It is at least an excellent tool for ''rapid'' prototyping.

The current configuration has many shortcomings as a maintenance robot. In its current form, it is more suitable to test various technologies and concepts. 

The current sensor configuration is set up to facilitate testing of \ac{SLAM} and navigation.

The current design of the mobile base is struggling to support the weight of the robot. The small wheels are struggling with small obstacles such as door thresholds or floor gaps in the entrance to elevators. \ac{MIMROex}, a comparable robot, is equipped with a variant of a differential drive base with larger wheels suitable for driving over steel gratings and slippery surfaces.



\subsection{The Kinect}

As mentioned in section \ref{}, the Kinect is an active sensor that measures depth by projecting an infra red speckle pattern onto the surroundings.  Kinect for Xbox 360 can't be used in commercial applications because of its license. There is however similar sensors that can replace the Kinect.

\subsection{Open Source Software and Security}

\ac{ROS} and other open source projects thrive on active communities of contributors. Both \ac{PCL} and \ac{ROS}, as well as many other libraries and frameworks, are built on a collaborative effort from researchers and developers across the globe. This is open structure is great for speeding up innovation. Issues and bugs can also be discovered more quickly by anyone. Another benefit is that every detail in an open source project is open for scrutiny by those who want to use it. This is also a problem in terms of security. While anyone can find bugs and issues, the code is also open to those who are looking for possible exploits and vulnerabilities. If a system is targeted for sabotage, and it is widely known that the system uses open source software, it might be more vulnerable to security threats.

